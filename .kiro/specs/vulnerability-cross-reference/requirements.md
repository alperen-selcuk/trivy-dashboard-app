# Requirements Document: Vulnerability Cross-Reference Tab

## Introduction

The dashboard needs a dedicated vulnerabilities tab that provides a cross-reference view of vulnerabilities across all images. Users should be able to search for a specific vulnerability (by CVE code or other identifier) and see which images are affected by it. Only active (latest) scans should be considered when showing affected images.

## Glossary

- **Vulnerability**: A security issue identified by Trivy (e.g., CVE-2021-12345)
- **CVE Code**: A unique identifier for a vulnerability (e.g., CVE-2021-12345)
- **Affected Image**: An image version that contains a specific vulnerability in its latest scan
- **Active Scan**: The most recent scan for an image version
- **Vulnerability Tab**: A dedicated section in the dashboard for cross-referencing vulnerabilities
- **Vulnerability Details**: Information about a specific vulnerability including CVE code, severity, description

## Requirements

### Requirement 1: Create Vulnerabilities Tab

**User Story:** As a security analyst, I want a dedicated view for vulnerabilities, so that I can analyze vulnerability patterns across all images.

#### Acceptance Criteria

1. WHEN viewing the dashboard, THE Dashboard SHALL display a "Vulnerabilities" tab alongside other tabs
2. WHEN the Vulnerabilities tab is active, THE Dashboard SHALL display a list of all unique vulnerabilities from active scans
3. WHEN displaying vulnerabilities, THE Dashboard SHALL show vulnerability identifier (CVE code or similar)
4. WHEN displaying vulnerabilities, THE Dashboard SHALL show severity level for each vulnerability

### Requirement 2: Search and Filter Vulnerabilities

**User Story:** As a security analyst, I want to search for specific vulnerabilities, so that I can quickly find affected images.

#### Acceptance Criteria

1. WHEN in the Vulnerabilities tab, THE Dashboard SHALL provide a search interface
2. WHEN searching by CVE code, THE Dashboard SHALL return matching vulnerabilities
3. WHEN searching by vulnerability description, THE Dashboard SHALL return matching vulnerabilities
4. WHEN no search results are found, THE Dashboard SHALL display a message indicating no matches

### Requirement 3: Display Affected Images

**User Story:** As a security analyst, I want to see which images are affected by a specific vulnerability, so that I can prioritize remediation efforts.

#### Acceptance Criteria

1. WHEN clicking on a vulnerability, THE Dashboard SHALL display all images affected by that vulnerability
2. WHEN displaying affected images, THE Dashboard SHALL only show images from active (latest) scans
3. WHEN displaying affected images, THE Dashboard SHALL show image name and version
4. WHEN displaying affected images, THE Dashboard SHALL show the severity of the vulnerability in that image
5. WHEN an image has multiple versions, THE Dashboard SHALL show only the latest version if it contains the vulnerability

### Requirement 4: Vulnerability Details View

**User Story:** As a security analyst, I want detailed information about a vulnerability and its impact, so that I can understand the risk.

#### Acceptance Criteria

1. WHEN viewing a vulnerability, THE Dashboard SHALL display the CVE code
2. WHEN viewing a vulnerability, THE Dashboard SHALL display the severity level
3. WHEN viewing a vulnerability, THE Dashboard SHALL display the description
4. WHEN viewing a vulnerability, THE Dashboard SHALL display affected package information
5. WHEN viewing a vulnerability, THE Dashboard SHALL display the list of affected images with their versions

### Requirement 5: Display CVE Reference Links

**User Story:** As a security analyst, I want to access CVE reference information directly from the dashboard, so that I can research vulnerabilities without leaving the application.

#### Acceptance Criteria

1. WHEN displaying a vulnerability, THE Dashboard SHALL show the CVE code if available (e.g., CVE-2021-12345)
2. WHEN a CVE code is available, THE Dashboard SHALL display a clickable link to the CVE reference
3. WHEN clicking a CVE link, THE Dashboard SHALL open the reference page in a new tab (e.g., https://nvd.nist.gov/vuln/detail/CVE-XXXX-XXXXX)
4. WHEN a vulnerability does not have a CVE code, THE Dashboard SHALL display "N/A" or similar indicator
5. WHEN displaying CVE information in the vulnerability list, THE Dashboard SHALL include both the code and the reference link
6. WHEN displaying CVE information in affected images view, THE Dashboard SHALL include the reference link for each vulnerability

